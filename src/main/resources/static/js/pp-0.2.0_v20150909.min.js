!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof module&&module.exports?module.exports=b():this[a]=b()}("Controller",function(){var a=function(a){this.publisher=a||this,this.subscribers=[]};a.prototype={add:function(a){for(var b=this.subscribers,c=0;c<b.length;c++){var d=b[c];if(d==a)return this}return this.subscribers.push(a),this},remove:function(a){for(var b=this.subscribers,c=0;c<b.length;c++){var d=b[c];if(d==a)return this.subscribers.splice(c,1),this}},deliver:function(a){for(var b=0;b<this.subscribers.length;b++){var c=this.subscribers[b];c.call(this.publisher,a)}}};var b=function(a){return a.target=a.target||a.srcElement,a.keyCode=a.keyCode||a.which,a.pageX=a.pageX||document.body.scrollLeft+a.clientX,a.pageY=a.pageY||document.body.scrollTop+a.clientY,a.preventDefault=a.preventDefault||function(){a.returnValue=!1},a.stopPropagation=a.stopPropagation||function(){a.cancelBubble=!0},a},c=function(a,b,c){try{a.addEventListener(b,c,!1)}catch(d){try{a.attachEvent("on"+b,c)}catch(d){}}},d=function(a,b,c){try{a.removeEventListener(b,c,!1)}catch(d){try{a.detachEvent("on"+b,c)}catch(d){}}},e=function(){var e=function(a,b){d(a,b,a.events[b].handlers,!1),a.events[b]=null};return{bind:function(d,e){for(var f=0;f<this.elms.length;f++){var g=this.elms[f];g.events=g.events||{},g.events[d]?g.events[d].add(e):(g.events[d]=new a(g).add(e),g.events[d].handlers=function(a){a=b(a),g.events[d].deliver(a)},c(g,d,g.events[d].handlers))}return this},unbind:function(a,b){for(var c=0;c<this.elms.length;c++){var d=this.elms[c];b?(d.events[a].remove(b),d.events[a].subscribers.length||e(d,a)):e(d,a)}return this},trigger:function(a){if(a){for(var b=0;b<this.elms.length;b++){var c=this.elms[b];c.events[a].deliver()}return this}}}},f=function(a){Object.prototype.toString.call(a).toLowerCase().indexOf("array")>0?this.elms=a:this.elms=[a]};define_prop=e(),define_prop.on=define_prop.bind,define_prop.un=define_prop.unbind,f.prototype=define_prop;var g={Publisher:a,define:function(a){return new f(a)}};return g}),function(a){"use strict";var b,c=a.Base64,d="2.1.8";"undefined"!=typeof module&&module.exports&&(b=require("buffer").Buffer);var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=function(a){for(var b={},c=0,d=a.length;d>c;c++)b[a.charAt(c)]=c;return b}(e),g=String.fromCharCode,h=function(a){if(a.length<2){var b=a.charCodeAt(0);return 128>b?a:2048>b?g(192|b>>>6)+g(128|63&b):g(224|b>>>12&15)+g(128|b>>>6&63)+g(128|63&b)}var b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return g(240|b>>>18&7)+g(128|b>>>12&63)+g(128|b>>>6&63)+g(128|63&b)},i=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,j=function(a){return a.replace(i,h)},k=function(a){var b=[0,2,1][a.length%3],c=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0),d=[e.charAt(c>>>18),e.charAt(c>>>12&63),b>=2?"=":e.charAt(c>>>6&63),b>=1?"=":e.charAt(63&c)];return d.join("")},l=a.btoa?function(b){return a.btoa(b)}:function(a){return a.replace(/[\s\S]{1,3}/g,k)},m=b?function(a){return(a.constructor===b.constructor?a:new b(a)).toString("base64")}:function(a){return l(j(a))},n=function(a,b){return b?m(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):m(String(a))},o=function(a){return n(a,!0)},p=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),q=function(a){switch(a.length){case 4:var b=(7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3),c=b-65536;return g((c>>>10)+55296)+g((1023&c)+56320);case 3:return g((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return g((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},r=function(a){return a.replace(p,q)},s=function(a){var b=a.length,c=b%4,d=(b>0?f[a.charAt(0)]<<18:0)|(b>1?f[a.charAt(1)]<<12:0)|(b>2?f[a.charAt(2)]<<6:0)|(b>3?f[a.charAt(3)]:0),e=[g(d>>>16),g(d>>>8&255),g(255&d)];return e.length-=[0,0,2,1][c],e.join("")},t=a.atob?function(b){return a.atob(b)}:function(a){return a.replace(/[\s\S]{1,4}/g,s)},u=b?function(a){return(a.constructor===b.constructor?a:new b(a,"base64")).toString()}:function(a){return r(t(a))},v=function(a){return u(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(){var b=a.Base64;return a.Base64=c,b};if(a.Base64={VERSION:d,atob:t,btoa:l,fromBase64:v,toBase64:n,utob:j,encode:n,encodeURI:o,btou:r,decode:v,noConflict:w},"function"==typeof Object.defineProperty){var x=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",x(function(){return v(this)})),Object.defineProperty(String.prototype,"toBase64",x(function(a){return n(this,a)})),Object.defineProperty(String.prototype,"toBase64URI",x(function(){return n(this,!0)}))}}a.Meteor&&(Base64=a.Base64)}(this),!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof module&&module.exports?module.exports=b():this[a]=b()}("Class",function(){var a=function(a){return/\s(\w+)/.exec(Object.prototype.toString.call(a).toLowerCase())[1]},b=function(a){for(key in a)this[key]=a[key];return this},c=function(c,d){var e,f=a(c),g=a(d);c="function"==f?[c]:"object"==f?(e=c)&&[c.constructor||function(){}]:[function(){}],e&&delete e.constructor,d="function"==g?(c=c.concat(d.constructor||d))&&d.prototype:"object"==g?d:null,e&&!d?(d=e,e=null):d=d||{},d.extended||(d.extended=b);var h=function(){e&&b.call(this,e)};h.prototype=d;var i=function(){for(var a=c.length,b=a-1;b>=0;b--)c[b].apply(this,arguments)};return i.constructor=c[0],i.prototype=new h,i.extended=function(d){return d.extended=d.extended||b,c=[this.constructor],this.prototype=d,"function"==a(d)&&(c=c.concat(d.constructor||d),this.prototype=d.prototype),this},i.implemented=function(a){this.prototype=(new h).extended(a)},i},d={};return d.create=c,d});var getPosition=function(a,b){for(var c=y=0,b=b||document.body;a!=b;)c+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent;return{x:c,y:y}},AutoComplete=Class.create({constructor:function(a){var b,c="keyup";if(this.tip=a.tip||"Please input the keywords",this.input=a.input,this.input){if(this.form=a.form,!this.form&&(b=this.input.parents("form"))&&b.length&&(this.form=b,b=null),this.submit=a.submit||this.submit,this.getDatas=a.getDatas||this.getDatas,this.suggest=a.suggest&&a.suggest.length?a.suggest:null,!this.suggest){var d=this.input.parent(),e=document.createElement("div");d.css("position","relative");var f=getPosition(this.input[0],d[0]).x,g=this.input.width(),h=getPosition(this.input[0],d[0]).y+this.input.height();e.style.cssText="top:"+h+"px;left:"+f+"px;width:"+g+"px;",e.className="suggest",d.append(e),this.suggest=jQuery(e)}this.suggest.hide(),this.list=(a.list||"li").toLowerCase(),this.hover=a.hover||"hover",this.input.attr("placeholder")||(this.input.val(this.tip),this.input.focus(jQuery.proxy(this.focus,this))),this.input.blur(jQuery.proxy(this.blur,this)),this.input.keydown(jQuery.proxy(this.keydown,this)),this.input.bind(c,jQuery.proxy(this.textInput,this)),this.form&&this.form.bind("submit",jQuery.proxy(this.submit,this)),this.suggest.delegate(this.list,"mouseover",jQuery.proxy(this.mouseover,this)),this.suggest.delegate(this.list,"click",jQuery.proxy(this.click,this))}},focus:function(){this.input.val()==this.tip&&this.input.val("")},blur:function(){var a=this;this.input.attr("placeholder")||""!=this.input.val()||this.input.val(this.tip),setTimeout(function(){a.suggest.hide(),a.current=null},500)},setInputValue:function(a){var b,c=this.list;this.current||(this.current=this.suggest.find(c).first()),b=this.current.attr("title")||this.current.text(),this.input.val(b)},click:function(){this.setInputValue(),this.suggest.hide()},submit:function(a){this.form&&a.preventDefault()},keydown:function(a){var b=a.keyCode,c=this.list,d=this.hover;if(38==b||40==b){if(!this.suggest.find(c).length)return;a.preventDefault(),this.current&&this.current.removeClass(d),38==b?this.current=this.current&&this.current.prev().length?this.current.prev():this.suggest.find(c).last():this.current=this.current&&this.current.next().length?this.current.next():this.suggest.find(c).first(),this.current.addClass(d),this.setInputValue()}else 13==b&&(this.setInputValue(),this.form||this.submit())},getDatas:function(){throw new Error('Method ".getDatas()" is needed.')},textInput:function(a){var b=a.keyCode;(!b||b>=48&&90>=b||b>=96&&105>=b||8==b||32==b||45==b)&&this.getDatas()},mouseover:function(a){for(var b=a.target;b&&b.nodeName.toLowerCase()!=this.list;)b=b.parentNode;b.nodeName.toLowerCase()==this.list&&(this.current&&this.current.removeClass(this.hover),this.current=jQuery(b),this.current.addClass(this.hover))}});!function(a){var b={base64:"https://github.com/dankogai/js-base64.git",controller:"https://github.com/abcrun/sack.git",autoComplete:"https://github.com/abcrun/sack.git",domready:function(a){var b=[],c=!1,d=function(){if(document.ready?"complete"==document.readyState&&(c=!0):c=!0,c){for(var a=0;a<b.length;a++)b[a]();try{document.removeEventListener("DOMContentLoaded",d,!1),window.removeEventListener("load",d,!1),document.detachEvent("onreadystatechange",d),window.detachEvent("onload",d),clearInterval(g)}catch(e){}}};try{document.addEventListener("DOMContentLoaded",d,!1),window.addEventListener("load",d,!1)}catch(e){document.attachEvent("onreadystatechange",d),window.attachEvent("onload",d);var f=0,g=setInterval(function(){100==f&&clearInterval(g);try{document.documentElement.doScroll("left"),clearInterval(g),d()}catch(a){}},100)}return function(a){c||"complete"==document.readyState?a():b.push(a)}}(),$:function(a,b){var b=b||document,c=a.charAt(0),d=a.substring(1);if("#"==c)return document.getElementById(d);if("."==c){var f=[];if(b.getElementsByClassName)f=b.getElementsByClassName(d);else{var g=b.getElementsByTagName("*");for(e in g){var h=g[e];1==h.nodeType&&h.className.indexOf(d)>-1&&f.push(h)}}if(f.length)return f[0]}return null},element:function(a,b,c,d){var e=document.createElement(a),d=d||document.body;return b&&(e.id=b),c&&(e.className=c),d.appendChild(e),e},loadCSS:function(a,b){var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.href=a,document.getElementsByTagName("head")[0].appendChild(c),c.onload=c.onreadystatechange=function(){(!this.readyState||/loaded|complete/.test(this.readyState))&&b&&b()}},getPosition:function(a,b){for(var c=y=0,b=b||document.body;a!=b;)c+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent;return{x:c,y:y}},placeholder:function(a,b){var b=b||document.body,c=Controller.define;if(a){var d=document.createElement("div"),e=this.getPosition(a,b),f=a.offsetWidth,g=a.offsetHeight;return d.innerHTML=a.getAttribute("placeholder"),d.className="placeholder",d.style.cssText="color:#999;background:transparent;font-size:12px;padding-left:10px;position:absolute;z-index:10000100;line-height:"+g+"px;width:"+f+"px;height:"+g+"px;left:"+e.x+"px;top:"+e.y+"px",b.appendChild(d),c(a).on("keyup",function(){""!=a.value?d.style.display="none":d.style.display=""}),c(a).on("blur",function(){""!=a.value?d.style.display="none":d.style.display=""}),c(d).on("click",function(){a.focus()}),d}},getScript:function(a,b){var c=document.createElement("script");c.type="text/javascript",c.src=a,document.body.appendChild(c),c.onload=c.onreadystatechange=function(){(!this.readyState||/loaded|complete/.test(this.readyState))&&(b&&b(),document.body.removeChild(c))}},getDomain:function(){var a=document.domain.split(".").slice(-3);return 2==a.length?document.domain:"com"==a[1]?a.join("."):a[1]+"."+a[2]},cookie:{get:function(a){var b,c=document.cookie,d=c.indexOf(a+"="),e=c.indexOf(";",d);return-1==e&&(e=c.length),d>-1?b=c.substring(d+a.length+1,e):null},set:function(a,b,c,d,e){var e=e||"/",f="";if(c){var g=new Date;g.setTime(g.getTime()+1e3*c),f="expires="+g.toGMTString()}document.cookie=a+"="+b+";"+f+";"+(d?"domain="+d:"")+";path="+e},remove:function(a,b,c){this.set(a,"",-1,b,c)}}},c=function(){var a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=(b.getDomain(),/^(?:1[34578]\d{9}|[a-z0-9-_\\.]+@([a-z0-9-]+[\\.]{1})+[a-z0-9-]+)$/i),r=encodeURIComponent(document.URL),s=function(){if(!F.cookie){var a=unescape(b.cookie.get("cerpreg-passport"));if(a){var c=a.split("|"),d=c[4];if(c&&d){var e=decodeURIComponent(Base64.decode(d)),f=e.split("|");F.cookie={};for(var g=0;g<f.length;g++){var h=f[g].split(":"),i=h[0],j=h[2];F.cookie[i]=j}}else F.cookie=!1}else F.cookie=!1}},t='<div class="login_pp"><div class="login_title"> <h1>登录联想账号</h1> <a class="close" href="javascript:void(0)">x</a></div> <div class="login_inputa"> <div class="img"> <img src="http://m2.lefile.cn/cerp/images/icon03.jpg"> </div>      <input class="account" type="text" placeholder="请输入手机号或邮箱"> </div> <div class="login_main"> <p></p> </div> <div class="login_inputb"> <div class="imgs"> <img src="http://m3.lefile.cn/cerp/images/icon04.jpg"> </div> <input class="pwd" type="password" placeholder="密码"> </div> <div class="captcha_wrapper hidden"><input class="captcha" type="text" placeholder="请输入验证码"/><img class="captcha_img" /><span class="captcha_tip">换一换</span></div><div class="login_main"> <p class="tip"></p> </div> <div class="login_mains"><label> <input class="persistent" checked type="checkbox"> <p>自动登录<a href="javascript:void(0)" class="forgetPwd">忘记密码？</a></p></label> </div> <div class="login_btn"> <a href="javascript:void(0)" class="submit">登&nbsp;&nbsp;录</a> </div><div class="cooperation">使用合作网站账号登录:<div class="cooperation_items"><a class="qq" href="javascript:void(0)" >QQ</a>|<a class="weibo" href="javascript:void(0)">微博</a></div></div><div class="login_footer"> <p>不是会员?&nbsp;&nbsp;<a class="regist" href="javascript:void(0)">立即注册</a></p> </div></div><div class="suggest"></div>',u="placeholder"in document.createElement("input"),v=[],w=function(){var d=0,e=setInterval(function(){C||40==d?(clearInterval(e),v=[b.placeholder(a,n),b.placeholder(c,n)]):d++},50)},x=function(){var a=b.cookie.get("leid")||"",c="1.";0!=a.indexOf(c)&&b.domready(function(){var a=document.createElement("iframe");a.style.cssText="display:none",a.src="http://"+"reg.lenovo.com.cn"+"/auth/anonymous",document.body.appendChild(a)})},y=function(){if(p&&(n.innerHTML=p),b.$(".qq",n).setAttribute("href","http://"+"reg.lenovo.com.cn"+"/auth/qqplat?ru="+r+"&tk="+F.ticket),b.$(".weibo",n).setAttribute("href","http://"+"reg.lenovo.com.cn"+"/auth/sinaplat?ru="+r+"&tk="+F.ticket),a=b.$(".account",n),c=b.$(".pwd",n),d=b.$(".captcha_wrapper",n),e=b.$(".captcha",n),f=b.$(".captcha_img",n),g=b.$(".captcha_tip",n),h=b.$(".persistent",n),i=b.$(".tip",n),j=b.$(".submit",n),k=b.$(".close",n),!(a&&c&&i&&j&&d&&e&&f&&g))throw new Error("缺少表单元素,请查看文档说明");if(F.isDefault&&"undefined"!=typeof jQuery){var l=jQuery;new AutoComplete({input:l(a),suggest:l(".suggest"),getDatas:function(){var b=a.value,c=b.split("@"),d=c[0],e=c[1]||"",f=["163.com","qq.com","126.com","sohu.com","sina.com"],g=[];return""==b?(this.current=null,void this.suggest.hide().html("")):(g.push('<li class="hover">'+b+"</li>"),""!=e&&0=="lenovo".indexOf(e)&&f.unshift("lenovo.com"),l.each(f,function(){this.indexOf(e)>-1&&g.push("<li>"+d+"@"+this+"</li>")}),this.suggest.html("<ul>"+g.join("")+"</ul>").show(),void(this.current=this.suggest.find("li").first()))},submit:function(){this.suggest.hide()}})}},z=function(a,c){var d=""==a?"clear_cookie?":"set_cookie?cookie="+a+"&",e=function(a){for(var a=a||"",c=0;c<E.length;c++){var e=E[c],f="http://reg."+e+"/auth/"+d+"domain="+e;if(e==a)return;b.getScript(f)}};e();var f=0,g=setInterval(function(){""==a?total=E.length:total=2,(sum==total||60==f)&&(clearInterval(g),c&&c(),sum=0),f++},50)},A=function(){var b=Controller.define,d=/(?:android|ios)/i.test(navigator.userAgent)?"touchend":"click";b(a).on("keyup",function(b){var d=b.keyCode;13==d&&(b.preventDefault(),/^\s*$/.test(this.value)?(i.innerHTML="账号不能为空",a.focus()):q.test(this.value)?(i.innerHTML="",c.focus()):(i.innerHTML="账号格式错误",a.focus()))}),b(a).on("blur",function(){/^\s*$/.test(this.value)&&(i.innerHTML="账号不能为空")}),b(c).on("keyup",function(a){var b=a.keyCode;13==b&&(D?e.focus():(a.preventDefault(),F.doLogin()))}),b(e).on("keyup",function(a){var b=a.keyCode;13==b&&(a.preventDefault(),F.doLogin())}),u||(e.value="请输入验证码",b(e).on("focus",function(){var a=e.value;"请输入验证码"==a&&(e.value="")})),b(e).on("blur",function(){var a=e.value;/^\s*$/.test(a)?i.innerHTML="请输入验证码":/^[0-9a-zA-Z]{4}$/.test(a)||(i.innerHTML="验证码格式错误")}),b([f,g]).on("click",function(){f.setAttribute("src","http://"+"captcha.lenovo.com.cn"+"/img?"+(new Date).getTime())}),b(j).on(d,function(a){a.preventDefault(),F.doLogin()}),k&&b(k).on(d,function(){F.hide(),D=!1})},B=function(a){var b=[];for(key in a)b.push(key+"="+a[key]);return b.join("&")},C=!1,D=!1,E="lenovo.com.cn,thinkworld.lenovo.cn,lenovovip.com.cn".split(","),F={cookie:!1,isDefault:!1,pullCookie:function(a){var b=encodeURIComponent(a.ck);b?z(b,l):l()},syncUserInfo:function(a){b.domready(function(){var c=b.cookie.get("cerpreg-passport");l=a||function(){},c?z(c,l):b.getScript("http://"+"reg.lenovo.com.cn"+"/cookie/get/p?callback=passport.pullCookie")})},isLogin:function(){return s(),this.cookie&&""!=this.cookie.lenovoId?!0:!1},init:function(a){var c=this;b.domready(function(){var d=a.ticket,e=a.elm,f=a.html,g=a.css;if(!d)return!1;if(c.ticket=d,passport.rootElement)throw new Error("请勿重复调用");n=e,p=f,e||f||(n=b.$("#ppWrapper")||b.element("div","ppWrapper","ppWrapper"),o=b.$("#ppMask")||b.element("div","ppMask","ppMask"),p=t,g="http://m3.lefile.cn/cerp/css/pp.min.869dea54.css",c.isDefault=!0),g?b.loadCSS(g,function(){C=!0}):C=!0,c.options=a.options,c.login=a.login,c.logout=a.logout,c.drawUserInfo=a.drawUserInfo,c.isLogin()?c.drawUserInfo&&c.drawUserInfo():(y(),A())})},doLogin:function(){if(!(a&&c&&d&&e&&f&&g&&i&&j))throw new Error("缺少表单元素,请查看文档说明");var k,l=a.value.replace(/\s/g,""),n=c.value,o=this.options?"&"+B(this.options):"";if(k=h?h.checked?"1":"0":1,""==l)return i.innerHTML="账号不能为空",void a.focus();if(!q.test(l))return i.innerHTML="账号格式错误",void a.focus();if(/^\s*$/.test(n))return i.innerHTML="密码不能为空",void c.focus();if(n.length<4)return i.innerHTML="密码不得小于4位",void c.focus();if(D){var p=e.value;if(/^\s*$/.test(p))return i.innerHTML="请输入验证码",void e.focus();if(!/^[0-9a-zA-Z]{4}$/.test(p))return i.innerHTML="验证码格式错误",void e.focus()}var r=D?"&piccode="+e.value:"";b.getScript("http://reg.lenovo.com.cn"+"/auth/v2/dologin?account="+l+"&password="+Base64.encode(n)+"&ps="+k+"&ticket="+this.ticket+o+r+"&callback=passport.loginCallback"),i.innerHTML="正在登录，请稍候... ...",m=setTimeout(function(){i.innerHTML="登录超时，请稍候重试"},1e4)},doLogout:function(){y(),A(),b.getScript("http://"+"reg.lenovo.com.cn"+"/auth/clear_cookie?domain="+"lenovo.com.cn",function(){z("",F.logoutAction)})},show:function(b,d){if(!this.ticket)throw new Error("初始化passport了吗");if(!this.isDefault)throw new Error("自定义界面别show了");if(this.isLogin())throw new Error("或许哪里出错了，您已登录");var e=document.documentElement.scrollWidth,f=d||100,g=b||(e-429)/2;if(o.style.cssText="display:block",n.style.cssText="display:block;left:"+g+"px;top:"+f+"px",a.value="",c.value="",i.innerHTML="",a.focus(),v.length||u)for(var h=0;h<v.length;h++){var j=v[h];j.style.display=""}else w()},hide:function(){if(!this.ticket)throw new Error("没有初始化吧");if(!this.isDefault)throw new Error("自定义界面接别hide了");o.style.display="none",n.style.display="none";for(var a=0;a<v.length;a++){var b=v[a];b.style.display="none"}},loginCallback:function(a){var b=a.ret;if(!i)throw new Error("缺少tip,请查看文档说明");if(m&&clearTimeout(m),"0"==b)z(encodeURIComponent(a["cerpreg-passprt"]),F.loginAction);else{if(("验证码错误"==a.msg||"帐号或密码错误"==a.msg)&&f.setAttribute("src","http://"+"captcha.lenovo.com.cn"+"/img?"+(new Date).getTime()),i.innerHTML=a.msg,D)return;var c=a.isshowpic;"false"==c&&(D=!0,f.setAttribute("src","http://"+"captcha.lenovo.com.cn"+"/img"),d.style.cssText="display:block")}},loginAction:function(){if(m&&clearTimeout(m),s(),F.isDefault&&(F.hide(),i.innerHTML=""),F.drawUserInfo&&F.drawUserInfo(),F.login&&F.login(),v.length){for(var a=0;a<v.length;a++){var b=v[a];n.removeChild(b)}v=[]}},logoutAction:function(){F.logout&&F.logout(),passport.cookie=!1}};return x(),F.isLogin()&&document.referrer.indexOf("reg.")>-1&&b.domready(function(){var a=encodeURIComponent(b.cookie.get("cerpreg-passport"));z(a)}),F}();c.util=b,a.passport=c,a.sum=0}(window),function(a){"use strict";var b,c=a.Base64,d="2.1.8";"undefined"!=typeof module&&module.exports&&(b=require("buffer").Buffer);var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=function(a){for(var b={},c=0,d=a.length;d>c;c++)b[a.charAt(c)]=c;return b}(e),g=String.fromCharCode,h=function(a){if(a.length<2){var b=a.charCodeAt(0);return 128>b?a:2048>b?g(192|b>>>6)+g(128|63&b):g(224|b>>>12&15)+g(128|b>>>6&63)+g(128|63&b)}var b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return g(240|b>>>18&7)+g(128|b>>>12&63)+g(128|b>>>6&63)+g(128|63&b)},i=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,j=function(a){return a.replace(i,h)},k=function(a){var b=[0,2,1][a.length%3],c=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0),d=[e.charAt(c>>>18),e.charAt(c>>>12&63),b>=2?"=":e.charAt(c>>>6&63),b>=1?"=":e.charAt(63&c)];return d.join("")},l=a.btoa?function(b){return a.btoa(b)}:function(a){return a.replace(/[\s\S]{1,3}/g,k)},m=b?function(a){return(a.constructor===b.constructor?a:new b(a)).toString("base64")}:function(a){return l(j(a))},n=function(a,b){return b?m(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):m(String(a))},o=function(a){return n(a,!0)},p=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),q=function(a){switch(a.length){case 4:var b=(7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3),c=b-65536;return g((c>>>10)+55296)+g((1023&c)+56320);case 3:return g((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return g((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},r=function(a){return a.replace(p,q)},s=function(a){var b=a.length,c=b%4,d=(b>0?f[a.charAt(0)]<<18:0)|(b>1?f[a.charAt(1)]<<12:0)|(b>2?f[a.charAt(2)]<<6:0)|(b>3?f[a.charAt(3)]:0),e=[g(d>>>16),g(d>>>8&255),g(255&d)];return e.length-=[0,0,2,1][c],e.join("")},t=a.atob?function(b){return a.atob(b)}:function(a){return a.replace(/[\s\S]{1,4}/g,s)},u=b?function(a){return(a.constructor===b.constructor?a:new b(a,"base64")).toString()}:function(a){return r(t(a))},v=function(a){return u(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(){var b=a.Base64;return a.Base64=c,b};if(a.Base64={VERSION:d,atob:t,btoa:l,fromBase64:v,toBase64:n,utob:j,encode:n,encodeURI:o,btou:r,decode:v,noConflict:w},"function"==typeof Object.defineProperty){var x=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",x(function(){return v(this)})),Object.defineProperty(String.prototype,"toBase64",x(function(a){return n(this,a)})),Object.defineProperty(String.prototype,"toBase64URI",x(function(){return n(this,!0)}))}}a.Meteor&&(Base64=a.Base64)}(this),function(a){a(function(){var b={$:function(a,b){var b=b||document,c=a.charAt(0),d=a.substring(1);if("#"==c)return document.getElementById(d);if("."==c){var f=[];if(b.getElementsByClassName)f=b.getElementsByClassName(d);else{var g=b.getElementsByTagName("*");for(e in g){var h=g[e];1==h.nodeType&&h.className.indexOf(d)>-1&&f.push(h)}}if(f.length)return f[0]}return null},element:function(a){var b=a.node,c=a.id,d=a.className,e=a.root,f=document.createElement(b),e=e||document.body;return c&&(f.id=c),d&&(f.className=d),e.appendChild(f),f},placeholder:function(b,c){var c=c||document.body;if(b){var d=document.createElement("div"),e=this.getPosition(b,c),f=b.offsetWidth,g=b.offsetHeight;return d.innerHTML=b.getAttribute("placeholder"),d.className="placeholder",d.style.cssText="color:#999;background:transparent;font-size:12px;padding-left:10px;position:absolute;z-index:10000100;line-height:"+g+"px;width:"+f+"px;height:"+g+"px;left:"+e.x+"px;top:"+e.y+"px",c.appendChild(d),a(b).on("keyup",function(){""!=b.value?d.style.display="none":d.style.display=""}),a(b).on("blur",function(){""!=b.value?d.style.display="none":d.style.display=""}),a(d).on("click",function(){b.focus()}),d}},getPosition:function(a,b){for(var c=y=0,b=b||document.body;a!=b;)c+=a.offsetLeft,y+=a.offsetTop,a=a.offsetParent;return{x:c,y:y}}},c=(document.body.scrollWidth,document.body.scrollHeight);0==c&&(c=document.documentElement.scrollHeight);var d="http://"+"reg.lenovo.com.cn",f=!1,g=function(a,b){var c=document.createElement("link");c.rel="stylesheet",c.type="text/css",c.href=a,document.getElementsByTagName("head")[0].appendChild(c),c.onload=c.onreadystatechange=function(){(!this.readyState||/loaded|complete/.test(this.readyState))&&b&&b()}};g("http://m2.lefile.cn/cerp/css/rr.min.1cf55e66.css",function(){f=!0});var h,i,j,k,l,m,n,o,p,q,r,s,t=/^(?:1[34578]\d{9}|[a-z0-9-_\\.]+@([a-z0-9-]+[\\.]{1})+[a-z0-9-]+)$/i,u=/(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?\.>\-\=\+<\(\),\[\];:\/]+)$)^[\w~!@#$%^&*?\.>\-\=\+<\(\),\[\];:\/]{8,20}$/,v=function(){if(j.hide(),i.hide(),D.length){for(var b=0;b<D.length;b++)a(D[b]).remove();D=[]}},w='<div class="enroll"> <div class="enroll_title"> <h1>欢迎注册联想会员</h1> <a class="close" href="javascript:void(0)">x</a></div> <div class="enroll_inputa"> <p>账号：<input class="account" type="text" placeholder="请输入手机号或邮箱"></p> </div> <div class="enroll_inputaa errorAccount"></div> <div class="enroll_inputb"> <p>密码：<input placeholder="密码长度8~20位，数字、字母、字符至少包含两种" class="pwd" type="password"/></p> </div> <div class="enroll_inputaa errorPwd"></div> <div class="enroll_inputc"> <p>确认密码：<input type="password" class="repwd"></p> </div> <div class="enroll_inputaa errorRepwd"></div> <div class="enroll_inputd"> <p>验证码：<input type="text" class="captcha"></p><img class="img_captcha"/><span class="img_captcha_tip">换一张</span><button class="mobile_captcha hidden">获取验证码</button></p> </div> <div class="enroll_inputaa errorCaptcha"></div> <div class="enroll_main"><label> <input type="checkbox" class="chk" checked> <p>我已阅读并同意<a class="agreePolicy" target="_blank" href="http://appserver.lenovo.com.cn/Public/public_bottom/privacy.shtml">《联想隐私权保护政策》</a></p></label> </div> <div class="enroll_btn"> <a class="submit" href="javascript:void(0)">立即注册</a> </div> </div>',x='<div class="password_one" style="left:0;top:0;background:#fff"> <div class="password_titles"> <p><span>找回密码</span>&nbsp;&nbsp;&gt;&gt;第一步</p>  <a class="close" href="javascript:void(0)">x</a></div> <div class="password_inputa"> <p>账号：<input class="account" type="text" placeholder="请输入手机或邮箱"></p> </div> <div class="enroll_inputaa errorAccount"> </div> <div class="password_inputb"> <p>验证码：<input class="captcha" type="text"></p><img class="img_captcha" /><span class="img_captcha_tip">换一张</span><button class="mobile_captcha hidden">获取验证码</button></div> <div class="enroll_inputaa errorCaptcha"> </div> <div class="password_btns"> <a href="javascript:void(0)" class="submit">下一步</a> </div> </div><div class="password_two hidden" style="left:0;top:0;background:#fff"> <div class="password_title"> <p><span>找回密码</span>&nbsp;&nbsp;&gt;&gt;第二步</p> <a class="close" href="javascript:void(0)">x</a></div> <div class="password_cont"> <img src="http://m1.lefile.cn/cerp/images/icon01.png"> <h1></h1> </div> <div class="password_btn"> <a href="javascript:void(0)">进入邮箱</a> </div> <div class="password_main"> <p>请您注意接收信息，并按照信息中的提示操作，完成安全验证。</p> </div> </div>',z={error:function(b){switch(b){case"0":a(".errorAccount,.rr_tip").html('<p class="error">请输入正确格式的帐号</p>');break;case"1":a(".errorPwd,.rr_tip").html('<p class="error">密码长度8-20位</p>');break;case"2":a(".errorPwd,.rr_tip").html('<p class="error">密码至少包含数字、字母、字符其中的2种</p>');break;case"3":a(".errorRepwd,.rr_tip").html('<p class="error">确认密码和密码不一致，请重新输入</p>');break;case"4":a(".errorCaptcha,.rr_tip").html('<p class="error">输入的验证码不对，请重新输入</p>');break;case"5":a(".errorCaptcha,.rr_tip").html('<p class="error">输入的验证码过期，请重新获取</p>');break;case"6":a(".errorAccount,.rr_tip").html('<p class="error">账号已存在</p>');break;case"7":a(".errorAccount,.rr_tip").html('<p class="error">账号不存在</p>');break;case"8":a(".errorAccount,.rr_tip").html('<p class="error">帐号不能为空</p>');break;case"9":a(".errorCaptcha,.rr_tip").html('<p class="error">验证码不能为空</p>');break;case"10":a(".errorPwd,.rr_tip").html('<p class="error">密码不能为空</p>')}},account:function(b){var c=k.val();return/^\s*$/.test(c)?void z.error("8"):t.test(c)?("recover"==b?a.getScript(d+"/auth/validateAccount?account="+c+"&callback=response.authAccountRecover"):a.getScript(d+"/auth/validateAccount?account="+c+"&callback=response.authAccount"),void a(".errorAccount,.rr_tip").html("")):void z.error("0")},pwd:function(){var b=l.val();return/^\s*$/.test(b)?void z.error("10"):b.length<8||b.length>20?void z.error("1"):u.test(b)?void a(".errorPwd,.rr_tip").html(""):void z.error("2")},repwd:function(){var b=l.val(),c=m.val();return b!=c?void z.error("3"):void a(".errorRepwd,.rr_tip").html("")},captcha:function(){var b=q.val();return/^\s*$/.test(b)?(z.error("9"),!1):(a(".errorCaptcha,.rr_tip").html(""),!0)},validate:function(){return this.account(),this.pwd(),this.repwd(),this.captcha(),i.find(".chk")[0].checked?i.find(".error").length?!1:!0:(a(".errorCaptcha").html("<p>请确认已阅读相关协议政策</p>"),!1)},validateRecover:function(){return this.account("recover"),this.captcha(),i.find(".error").length?!1:!0}},A={getPicCode:function(){var b=k.val();a.getScript(d+"/captcha/pic/show?mobile="+b+"&callback=response.getEmailCaptCode")},getMobileCode:function(){var b=k.val(),c=1;/^\s*$/.test(b)||F.isDefault&&a(".errorAccount .error").length||i.find(".tip .error").length||"disabled"!=p.attr("disabled")&&(a.getScript(d+"/captcha/mobile/show?mobile="+b+"&callback=response.getMobileCaptCode"),p.attr("disabled","disabled").html("60秒后重新获取"),h=setInterval(function(){60==c?(clearInterval(h),p.removeAttr("disabled").html("获取验证码")):(p.html(60-c+"秒后重新获取"),c++)},1e3))}},B={authAccount:function(a){if("1"==a)z.error("6"),p.hide(),n.show(),o.show();else{var b=k.val();/^\d{11}$/.test(b)?(n.hide(),o.hide(),p.show()):(p.hide(),n.show(),o.show())}},authAccountRecover:function(a){"0"==a&&z.error("7")},getEmailCaptCode:function(a){var b="data:image/png;base64,"+a;n.attr("src",b)},getMobileCaptCode:function(a){}},C="placeholder"in document.createElement("input"),D=[],E=function(){var a=b.$("#ppInfo"),c=b.$(".account",a),d=b.$(".pwd",a);D=d?[b.placeholder(c,a),b.placeholder(d,a)]:[b.placeholder(c,a)]},F={isDefault:!1,submit:function(){var b=k.val(),c=l.val(),d=q.val();z.validate()&&a.getScript("http://reg.lenovo.com.cn"+"/auth/v1/doregist?account="+b+"&password="+Base64.encode(c)+"&ticket="+r+"&captcha="+d+"&callback=regist.submitResponse")},submitResponse:function(b){var c=b.ret;if(0==c){if("undefined"==typeof passport)throw new Error("尚未加载passport");passport.ticket||passport.init({ticket:r}),passport.login=s||passport.login||function(){};var e=k.val(),f=l.val();q.val();F.isDefault&&i.remove(),a.getScript(d+"/auth/v1/dologin?account="+e+"&password="+Base64.encode(f)+"&ps=1&ticket="+r+"&callback=passport.loginCallback")}else z.error(b.errcode)},init:function(c,e){var g;if("string"==typeof c?r=c:(r=c.ticket,g=c.elm,s=c.success),r){if(i=g,e&&(d=e),!g){this.isDefault=!0,a("#ppInfo").length||(i=a(b.element({node:"div",id:"ppInfo",className:"ppInfo"}))),i=i||a("#ppInfo"),i.css("width","429px"),a("#ppMask").length||(j=a(b.element({node:"div",id:"ppMask",className:"ppMask"}))),j=j||a("#ppMask"),j.css("display","block"),i.html(w),i.css("display","block");var h=i.find(".close");if(h.on("click",v),D.length||C){if(D.length)for(var t=0;t<D.length;t++){var u=D[t];u.style.display=""}}else var t=0,x=setInterval(function(){f||40==t?(clearInterval(x),E()):t++},50)}k=i.find(".account"),l=i.find(".pwd"),m=i.find(".repwd"),q=i.find(".captcha"),n=i.find(".img_captcha"),o=i.find(".img_captcha_tip"),p=i.find(".mobile_captcha"),
A.getPicCode(),setTimeout(function(){k.focus()},500),k.on("blur",z.account),l.on("blur",z.pwd),m.on("blur",z.repwd),n.on("click",A.getPicCode),o.on("click",A.getPicCode),p.on("click",A.getMobileCode),q.on("keyup",function(a){var b=a.keyCode;13==b&&F.submit()}),i.find(".submit").on("click",F.submit)}}},G={submit:function(){var b=a("#ppInfo .account").val(),c=a("#ppInfo .captcha").val();z.validateRecover()&&a.getScript(d+"/pwd/findPassword?account="+b+"&captcha="+c+"&callback=recover.submitResponse")},submitResponse:function(b){var c=b.ret,d=a("#ppInfo .account").val();if(0==c){if(a(".password_one").hide(),i.css("marginLeft","-465px"),/^\d{11}$/.test(d))a(".password_cont h1").html("恭喜您，重置链接已经发送到您的手机，点击短信中的连接进行密码重置"),a(".password_btn").hide();else{var e="http://mail."+d.split("@")[1];a(".password_cont h1").html("恭喜您，重置链接已经发送到您的"+d+"邮箱，点击邮箱中的连接进行密码重置"),a(".password_btn a").attr("href",e)}i.css("width","930"),a(".password_two").show()}else z.error(b.errcode)},init:function(c){if(c&&(d=c),a("#ppInfo").length||(i=a(b.element({node:"div",id:"ppInfo",className:"ppInfo"}))),i=i||a("#ppInfo"),i.css("width","460px"),a("#ppMask").length||(j=a(b.element({node:"div",id:"ppMask",className:"ppMask"}))),j=j||a("#ppMask"),j.css("display","block"),i.html(x).css("display","block"),D.length||C)for(var e=0;e<D.length;e++){var g=D[e];g.style.display=""}else var e=0,h=setInterval(function(){f||40==e?(clearInterval(h),E()):e++},50);k=i.find(".account"),l=i.find(".pwd"),m=i.find(".repwd"),q=i.find(".captcha"),n=i.find(".img_captcha"),o=i.find(".img_captcha_tip"),p=i.find(".mobile_captcha"),A.getPicCode(),setTimeout(function(){k.focus()},500),k.on("blur",function(){z.account("recover")}),n.on("click",A.getPicCode),o.on("click",A.getPicCode),p.on("click",A.getMobileCode),q.on("keyup",function(a){var b=a.keyCode;13==b&&G.submit()}),i.find(".submit").on("click",G.submit);var r=i.find(".close");r.on("click",v)}};window.regist=F,window.recover=G,window.response=B})}(jQuery);